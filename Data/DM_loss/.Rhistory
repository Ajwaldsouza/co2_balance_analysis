View(dataset_peat_out)
View(dataset_peat)
#generating summary data
summary_cum_co2_peat <- summarySE(data=dataset_peat_out, measurevar="cum_co2_g",
groupvars=c("trmt"), na.rm = T)%>%as_tibble()%>%dplyr::rename(
sd_co2 = sd,
se_co2 = se,
ci_co2 = ci
)
View(dataset_peat_out)
View(dm_peat)
summary_dm_peat <- summarySE(data=dataset_peat_out, measurevar="dm_loss",
groupvars=c("trmt"), na.rm = T)%>%as_tibble()%>%dplyr::rename(
sd_dm = sd,
se_dm = se,
ci_dm = ci
)
summary_peat <- cbind(summary_cum_co2_peat, summary_dm_peat)%>%select(-c(2,7,8))
p_peat <- ggplot(data=dataset_peat, aes(x=dm_loss, y=cum_co2_g))+
stat_smooth(formula = y~x, method = "lm", alpha= 0.3, color= "#0571b0")+
stat_cor(aes(label = paste(..rr.label.., ..p.label.., sep = "~`,`~")))+
# stat_cor(method = "pearson")+
geom_point(aes(shape = trmt), size=2)+
geom_point(data = summary_peat, aes(x=dm_loss, y=cum_co2_g, shape = trmt), color="#ca0020", size=3.5)+
geom_errorbar(data = summary_peat, aes(xmin=dm_loss-se_dm, xmax=dm_loss+se_dm), color="#ca0020", width=0.5)+
geom_errorbar(data = summary_peat, aes(ymin=cum_co2_g-se_co2, ymax=cum_co2_g+se_co2), color="#ca0020", width=0.25)+
scale_shape_manual(name = "SCG (% of total mixture)",
values=c(15, 16, 17, 8),
labels = c("0%", "15%","30%", "50%"))+
scale_y_continuous(limits = c(0,21), breaks=seq(0, 25,5))+
scale_x_continuous(limits = c(0,21), breaks=seq(0, 20,5))+
labs(x = "Dry matter loss (grams)", y=expression(Cumulative~CO[2]~(grams)))+
theme_pubr()
p_peat
p_peat <- ggplot(data=dataset_peat_out, aes(x=dm_loss, y=cum_co2_g))+
stat_smooth(formula = y~x, method = "lm", alpha= 0.3, color= "#0571b0")+
stat_cor(aes(label = paste(..rr.label.., ..p.label.., sep = "~`,`~")))+
# stat_cor(method = "pearson")+
geom_point(aes(shape = trmt), size=2)+
geom_point(data = summary_peat, aes(x=dm_loss, y=cum_co2_g, shape = trmt), color="#ca0020", size=3.5)+
geom_errorbar(data = summary_peat, aes(xmin=dm_loss-se_dm, xmax=dm_loss+se_dm), color="#ca0020", width=0.5)+
geom_errorbar(data = summary_peat, aes(ymin=cum_co2_g-se_co2, ymax=cum_co2_g+se_co2), color="#ca0020", width=0.25)+
scale_shape_manual(name = "SCG (% of total mixture)",
values=c(15, 16, 17, 8),
labels = c("0%", "15%","30%", "50%"))+
scale_y_continuous(limits = c(0,21), breaks=seq(0, 25,5))+
scale_x_continuous(limits = c(0,21), breaks=seq(0, 20,5))+
labs(x = "Dry matter loss (grams)", y=expression(Cumulative~CO[2]~(grams)))+
theme_pubr()
p_peat
#Saving the plot
# Call the pdf command to start the plot
pdf(file = "dm_loss_vs_co2_peat.pdf",   # The directory you want to save the file in
width = 5.83, # The width of the plot in inches
height = 4.13)
p_peat
dev.off()
dm_plug <- read_xlsx("DM_loss_plug.xlsx", sheet = "means")%>%as_tibble()%>%select(c(11))
cum_co2_plug <- read_csv("co2_cum_g_plug.csv")%>%as_tibble()%>%slice(-c(17))
dataset_plug <- cbind(cum_co2_plug, dm_plug)
dataset_plug$trmt <- as.factor(dataset_plug$trmt)
dataset_plug_out <- dataset_plug%>%slice(-c(3, 7, 10, 16))
#generating summary data
summary_cum_co2_plug <- summarySE(data=dataset_plug_out, measurevar="cum_co2_g",
groupvars=c("trmt"), na.rm = T)%>%as_tibble()%>%dplyr::rename(
sd_co2 = sd,
se_co2 = se,
ci_co2 = ci
)
summary_dm_plug <- summarySE(data=dataset_plug_out, measurevar="dm_loss",
groupvars=c("trmt"), na.rm = T)%>%as_tibble()%>%dplyr::rename(
sd_dm = sd,
se_dm = se,
ci_dm = ci
)
#generating summary data
summary_cum_co2_plug <- summarySE(data=dataset_plug_out, measurevar="cum_co2_g",
groupvars=c("trmt"), na.rm = T)%>%as_tibble()%>%dplyr::rename(
sd_co2 = sd,
se_co2 = se,
ci_co2 = ci
)
summary_dm_plug <- summarySE(data=dataset_plug_out, measurevar="dm_loss",
groupvars=c("trmt"), na.rm = T)%>%as_tibble()%>%dplyr::rename(
sd_dm = sd,
se_dm = se,
ci_dm = ci
)
summary_plug <- cbind(summary_cum_co2_plug, summary_dm_plug)%>%select(-c(2,7,8))
p_plug <- ggplot(data=dataset_plug_out, aes(x=dm_loss, y=cum_co2_g))+
stat_smooth(formula = y~x, method = "lm", alpha= 0.3, color= "#0571b0")+
stat_cor(aes(label = paste(..rr.label.., ..p.label.., sep = "~`,`~")))+
# stat_cor(method = "pearson")+
geom_point(aes(shape = trmt), size=2)+
geom_point(data = summary_plug, aes(x=dm_loss, y=cum_co2_g, shape = trmt), color="#ca0020", size=3.5)+
geom_errorbar(data = summary_plug, aes(xmin=dm_loss-se_dm, xmax=dm_loss+se_dm), color="#ca0020", width=0.5)+
geom_errorbar(data = summary_plug, aes(ymin=cum_co2_g-se_co2, ymax=cum_co2_g+se_co2), color="#ca0020", width=0.25)+
scale_shape_manual(name = "SCG (% of total mixture)",
values=c(15, 16, 17, 8),
labels = c("0%", "15%","30%", "50%"))+
scale_y_continuous(limits = c(0,21), breaks=seq(0, 25,5))+
scale_x_continuous(limits = c(0,21), breaks=seq(0, 20,5))+
labs(x = "Dry matter loss (grams)", y=expression(Cumulative~CO[2]~(grams)))+
theme_pubr()
p_plug
#_______________________________________________________________________________
## Compiling figures
fig <- ggarrange(p_peat, p_plug, labels = c("a", "b"),ncol = 2, nrow = 1,
common.legend = T, legend = "bottom")
ggsave(file="dm_loss_vs_co2.pdf", plot=fig, width=10, height=4.5)
# dm_plug <- read_xlsx("DM_loss_plug.xlsx", sheet = "means")%>%as_tibble()%>%select(c(11))
cum_co2_plug <- read_csv("co2_cum_g_plug.csv")%>%as_tibble()%>%slice(-c(17))
dm_plug <- read_csv("C_mineralization_plug.csv")%>%as_tibble()%>%select(c(5))
View(dm_plug)
dataset_plug <- cbind(cum_co2_plug, dm_plug)
dataset_plug$trmt <- as.factor(dataset_plug$trmt)
dataset_plug_out <- dataset_plug%>%slice(-c(3, 7, 10, 16))
#generating summary data
summary_cum_co2_plug <- summarySE(data=dataset_plug_out, measurevar="cum_co2_g",
groupvars=c("trmt"), na.rm = T)%>%as_tibble()%>%dplyr::rename(
sd_co2 = sd,
se_co2 = se,
ci_co2 = ci
)
summary_dm_plug <- summarySE(data=dataset_plug_out, measurevar="dm_loss",
groupvars=c("trmt"), na.rm = T)%>%as_tibble()%>%dplyr::rename(
sd_dm = sd,
se_dm = se,
ci_dm = ci
)
View(dm_plug)
summary_dm_plug <- summarySE(data=dataset_plug_out, measurevar="c_loss",
groupvars=c("trmt"), na.rm = T)%>%as_tibble()%>%dplyr::rename(
sd_dm = sd,
se_dm = se,
ci_dm = ci
)
summary_plug <- cbind(summary_cum_co2_plug, summary_dm_plug)%>%select(-c(2,7,8))
p_plug <- ggplot(data=dataset_plug_out, aes(x=c_loss, y=cum_co2_g))+
stat_smooth(formula = y~x, method = "lm", alpha= 0.3, color= "#0571b0")+
stat_cor(aes(label = paste(..rr.label.., ..p.label.., sep = "~`,`~")))+
# stat_cor(method = "pearson")+
geom_point(aes(shape = trmt), size=2)+
geom_point(data = summary_plug, aes(x=c_loss, y=cum_co2_g, shape = trmt), color="#ca0020", size=3.5)+
geom_errorbar(data = summary_plug, aes(xmin=c_loss-se_dm, xmax=c_loss+se_dm), color="#ca0020", width=0.5)+
geom_errorbar(data = summary_plug, aes(ymin=cum_co2_g-se_co2, ymax=cum_co2_g+se_co2), color="#ca0020", width=0.25)+
scale_shape_manual(name = "SCG (% of total mixture)",
values=c(15, 16, 17, 8),
labels = c("0%", "15%","30%", "50%"))+
scale_y_continuous(limits = c(0,21), breaks=seq(0, 25,5))+
scale_x_continuous(limits = c(0,21), breaks=seq(0, 20,5))+
labs(x = "Dry matter loss (grams)", y=expression(Cumulative~CO[2]~(grams)))+
theme_pubr()
p_plug
View(dataset_plug_out)
# dm_plug <- read_xlsx("DM_loss_plug.xlsx", sheet = "means")%>%as_tibble()%>%select(c(11))
cum_co2_plug <- read_csv("co2_cum_g_plug.csv")%>%as_tibble()%>%slice(-c(17))
dm_plug <- read_csv("C_mineralization_plug.csv")%>%as_tibble()%>%select(c(5))
dataset_plug <- cbind(cum_co2_plug, dm_plug)
dataset_plug$trmt <- as.factor(dataset_plug$trmt)
dataset_plug_out <- dataset_plug%>%slice(-c(3, 7, 10, 16))
#generating summary data
summary_cum_co2_plug <- summarySE(data=dataset_plug_out, measurevar="cum_co2_g",
groupvars=c("trmt"), na.rm = T)%>%as_tibble()%>%dplyr::rename(
sd_co2 = sd,
se_co2 = se,
ci_co2 = ci
)
summary_dm_plug <- summarySE(data=dataset_plug_out, measurevar="c_loss",
groupvars=c("trmt"), na.rm = T)%>%as_tibble()%>%dplyr::rename(
sd_dm = sd,
se_dm = se,
ci_dm = ci
)
summary_plug <- cbind(summary_cum_co2_plug, summary_dm_plug)%>%select(-c(2,7,8))
p_plug <- ggplot(data=dataset_plug_out, aes(x=c_loss, y=cum_co2_g))+
stat_smooth(formula = y~x, method = "lm", alpha= 0.3, color= "#0571b0")+
stat_cor(aes(label = paste(..rr.label.., ..p.label.., sep = "~`,`~")))+
# stat_cor(method = "pearson")+
geom_point(aes(shape = trmt), size=2)+
geom_point(data = summary_plug, aes(x=c_loss, y=cum_co2_g, shape = trmt), color="#ca0020", size=3.5)+
geom_errorbar(data = summary_plug, aes(xmin=c_loss-se_dm, xmax=c_loss+se_dm), color="#ca0020", width=0.5)+
geom_errorbar(data = summary_plug, aes(ymin=cum_co2_g-se_co2, ymax=cum_co2_g+se_co2), color="#ca0020", width=0.25)+
scale_shape_manual(name = "SCG (% of total mixture)",
values=c(15, 16, 17, 8),
labels = c("0%", "15%","30%", "50%"))+
scale_y_continuous(limits = c(0,21), breaks=seq(0, 25,5))+
scale_x_continuous(limits = c(0,21), breaks=seq(0, 20,5))+
labs(x = "Dry matter loss (grams)", y=expression(Cumulative~CO[2]~(grams)))+
theme_pubr()
p_plug
p_plug <- ggplot(data=dataset_plug_out, aes(x=c_loss, y=cum_co2_g))+
stat_smooth(formula = y~x, method = "lm", alpha= 0.3, color= "#0571b0")+
stat_cor(aes(label = paste(..rr.label.., ..p.label.., sep = "~`,`~")))+
# stat_cor(method = "pearson")+
geom_point(aes(shape = trmt), size=2)+
geom_point(data = summary_plug, aes(x=c_loss, y=cum_co2_g, shape = trmt), color="#ca0020", size=3.5)+
geom_errorbar(data = summary_plug, aes(xmin=c_loss-se_dm, xmax=c_loss+se_dm), color="#ca0020", width=0.5)+
geom_errorbar(data = summary_plug, aes(ymin=cum_co2_g-se_co2, ymax=cum_co2_g+se_co2), color="#ca0020", width=0.25)+
scale_shape_manual(name = "SCG (% of total mixture)",
values=c(15, 16, 17, 8),
labels = c("0%", "15%","30%", "50%"))+
scale_y_continuous(limits = c(0,21), breaks=seq(0, 25,5))+
scale_x_continuous(limits = c(0,21), breaks=seq(0, 20,5))+
labs(x = "Dry matter loss (grams)", y=expression(Cumulative~CO[2]~(grams)))+
theme_pubr()
p_plug
dm_peat <- read_csv("C_mineralization_peat.csv")%>%as_tibble()%>%select(c(5))
cum_co2_peat <- read_csv("co2_cum_g_peat.csv")%>%as_tibble()%>%select(-c(1,4,5))%>%slice(-c(17))
dataset_peat <- cbind(cum_co2_peat, dm_peat)
dataset_peat$trmt <- as.factor(dataset_peat$trmt)
dataset_peat_out <- dataset_peat%>%slice(-c(3, 8, 9, 13))
#generating summary data
summary_cum_co2_peat <- summarySE(data=dataset_peat_out, measurevar="cum_co2_g",
groupvars=c("trmt"), na.rm = T)%>%as_tibble()%>%dplyr::rename(
sd_co2 = sd,
se_co2 = se,
ci_co2 = ci
)
summary_dm_peat <- summarySE(data=dataset_peat_out, measurevar="c_loss",
groupvars=c("trmt"), na.rm = T)%>%as_tibble()%>%dplyr::rename(
sd_dm = sd,
se_dm = se,
ci_dm = ci
)
summary_peat <- cbind(summary_cum_co2_peat, summary_dm_peat)%>%select(-c(2,7,8))
p_peat <- ggplot(data=dataset_peat_out, aes(x=c_loss, y=cum_co2_g))+
stat_smooth(formula = y~x, method = "lm", alpha= 0.3, color= "#0571b0")+
stat_cor(aes(label = paste(..rr.label.., ..p.label.., sep = "~`,`~")))+
# stat_cor(method = "pearson")+
geom_point(aes(shape = trmt), size=2)+
geom_point(data = summary_peat, aes(x=dm_loss, y=cum_co2_g, shape = trmt), color="#ca0020", size=3.5)+
geom_errorbar(data = summary_peat, aes(xmin=dm_loss-se_dm, xmax=dm_loss+se_dm), color="#ca0020", width=0.5)+
geom_errorbar(data = summary_peat, aes(ymin=cum_co2_g-se_co2, ymax=cum_co2_g+se_co2), color="#ca0020", width=0.25)+
scale_shape_manual(name = "SCG (% of total mixture)",
values=c(15, 16, 17, 8),
labels = c("0%", "15%","30%", "50%"))+
scale_y_continuous(limits = c(0,21), breaks=seq(0, 25,5))+
scale_x_continuous(limits = c(0,21), breaks=seq(0, 20,5))+
labs(x = "Dry matter loss (grams)", y=expression(Cumulative~CO[2]~(grams)))+
theme_pubr()
p_peat <- ggplot(data=dataset_peat_out, aes(x=c_loss, y=cum_co2_g))+
stat_smooth(formula = y~x, method = "lm", alpha= 0.3, color= "#0571b0")+
stat_cor(aes(label = paste(..rr.label.., ..p.label.., sep = "~`,`~")))+
# stat_cor(method = "pearson")+
geom_point(aes(shape = trmt), size=2)+
geom_point(data = summary_peat, aes(x=c_loss, y=cum_co2_g, shape = trmt), color="#ca0020", size=3.5)+
geom_errorbar(data = summary_peat, aes(xmin=c_loss-se_dm, xmax=c_loss+se_dm), color="#ca0020", width=0.5)+
geom_errorbar(data = summary_peat, aes(ymin=cum_co2_g-se_co2, ymax=cum_co2_g+se_co2), color="#ca0020", width=0.25)+
scale_shape_manual(name = "SCG (% of total mixture)",
values=c(15, 16, 17, 8),
labels = c("0%", "15%","30%", "50%"))+
scale_y_continuous(limits = c(0,21), breaks=seq(0, 25,5))+
scale_x_continuous(limits = c(0,21), breaks=seq(0, 20,5))+
labs(x = "Dry matter loss (grams)", y=expression(Cumulative~CO[2]~(grams)))+
theme_pubr()
p_peat
cum_co2_peat <- read_csv("co2_cum_g_peat.csv")%>%as_tibble()%>%select(-c(1,4,5))%>%slice(-c(17))
dm_peat <- read_csv("C_mineralization_peat.csv")%>%as_tibble()%>%select(c(5))
View(dm_peat)
dataset_peat <- cbind(cum_co2_peat, dm_peat)
View(dataset_peat)
cum_co2_peat <- read_csv("co2_cum_g_peat.csv")%>%as_tibble()%>%select(-c(1,4,5))%>%slice(-c(17))
dm_peat <- read_csv("C_mineralization_peat.csv")%>%as_tibble()%>%select(c(5))
dataset_peat <- cbind(cum_co2_peat, dm_peat)
dataset_peat$trmt <- as.factor(dataset_peat$trmt)
dataset_peat_out <- dataset_peat%>%slice(-c(3, 8, 9, 13))
#generating summary data
summary_cum_co2_peat <- summarySE(data=dataset_peat_out, measurevar="cum_co2_g",
groupvars=c("trmt"), na.rm = T)%>%as_tibble()%>%dplyr::rename(
sd_co2 = sd,
se_co2 = se,
ci_co2 = ci
)
summary_dm_peat <- summarySE(data=dataset_peat_out, measurevar="c_loss",
groupvars=c("trmt"), na.rm = T)%>%as_tibble()%>%dplyr::rename(
sd_dm = sd,
se_dm = se,
ci_dm = ci
)
summary_peat <- cbind(summary_cum_co2_peat, summary_dm_peat)%>%select(-c(2,7,8))
p_peat <- ggplot(data=dataset_peat_out, aes(x=c_loss, y=cum_co2_g))+
stat_smooth(formula = y~x, method = "lm", alpha= 0.3, color= "#0571b0")+
stat_cor(aes(label = paste(..rr.label.., ..p.label.., sep = "~`,`~")))+
# stat_cor(method = "pearson")+
geom_point(aes(shape = trmt), size=2)+
geom_point(data = summary_peat, aes(x=c_loss, y=cum_co2_g, shape = trmt), color="#ca0020", size=3.5)+
geom_errorbar(data = summary_peat, aes(xmin=c_loss-se_dm, xmax=c_loss+se_dm), color="#ca0020", width=0.5)+
geom_errorbar(data = summary_peat, aes(ymin=cum_co2_g-se_co2, ymax=cum_co2_g+se_co2), color="#ca0020", width=0.25)+
scale_shape_manual(name = "SCG (% of total mixture)",
values=c(15, 16, 17, 8),
labels = c("0%", "15%","30%", "50%"))+
scale_y_continuous(limits = c(0,21), breaks=seq(0, 25,5))+
scale_x_continuous(limits = c(0,21), breaks=seq(0, 20,5))+
labs(x = "Dry matter loss (grams)", y=expression(Cumulative~CO[2]~(grams)))+
theme_pubr()
p_peat
cum_co2_peat <- read_csv("co2_cum_g_peat.csv")%>%as_tibble()%>%select(-c(1,4,5))%>%slice(-c(17))
dm_peat <- read_csv("C_mineralization_peat.csv")%>%as_tibble()%>%select(c(5))
dataset_peat <- cbind(cum_co2_peat, dm_peat)
dataset_peat$trmt <- as.factor(dataset_peat$trmt)
dataset_peat_out <- dataset_peat%>%slice(-c(3, 8, 9, 13))
#generating summary data
summary_cum_co2_peat <- summarySE(data=dataset_peat_out, measurevar="cum_co2_g",
groupvars=c("trmt"), na.rm = T)%>%as_tibble()%>%dplyr::rename(
sd_co2 = sd,
se_co2 = se,
ci_co2 = ci
)
summary_dm_peat <- summarySE(data=dataset_peat_out, measurevar="c_loss",
groupvars=c("trmt"), na.rm = T)%>%as_tibble()%>%dplyr::rename(
sd_dm = sd,
se_dm = se,
ci_dm = ci
)
summary_peat <- cbind(summary_cum_co2_peat, summary_dm_peat)%>%select(-c(2,7,8))
p_peat <- ggplot(data=dataset_peat_out, aes(x=c_loss, y=cum_co2_g))+
stat_smooth(formula = y~x, method = "lm", alpha= 0.3, color= "#0571b0")+
stat_cor(aes(label = paste(..rr.label.., ..p.label.., sep = "~`,`~")))+
# stat_cor(method = "pearson")+
geom_point(aes(shape = trmt), size=2)+
geom_point(data = summary_peat, aes(x=c_loss, y=cum_co2_g, shape = trmt), color="#ca0020", size=3.5)+
geom_errorbar(data = summary_peat, aes(xmin=c_loss-se_dm, xmax=c_loss+se_dm), color="#ca0020", width=0.5)+
geom_errorbar(data = summary_peat, aes(ymin=cum_co2_g-se_co2, ymax=cum_co2_g+se_co2), color="#ca0020", width=0.25)+
scale_shape_manual(name = "SCG (% of total mixture)",
values=c(15, 16, 17, 8),
labels = c("0%", "15%","30%", "50%"))+
scale_y_continuous(limits = c(0,21), breaks=seq(0, 25,5))+
scale_x_continuous(limits = c(0,21), breaks=seq(0, 20,5))+
labs(x = "Dry matter loss (grams)", y=expression(Cumulative~CO[2]~(grams)))+
theme_pubr()
p_peat
librarian::shelf(tidyverse, ggplot2, dplyr, tibble, readr, lubridate, ggpubr,
scales, tidyr, rstudioapi,readxl,Rmisc,
update_all = FALSE)
##Setup working Directory
setwd(dirname(getActiveDocumentContext()$path))                                 # Set working directory to source file location
cum_co2_peat <- read_csv("co2_cum_g_peat.csv")%>%as_tibble()%>%select(-c(1,4,5))%>%slice(-c(17))
dm_peat <- read_csv("C_mineralization_peat.csv")%>%as_tibble()%>%select(c(5))
dataset_peat <- cbind(cum_co2_peat, dm_peat)
dataset_peat$trmt <- as.factor(dataset_peat$trmt)
dataset_peat_out <- dataset_peat%>%slice(-c(3, 8, 9, 13))
#generating summary data
summary_cum_co2_peat <- summarySE(data=dataset_peat_out, measurevar="cum_co2_g",
groupvars=c("trmt"), na.rm = T)%>%as_tibble()%>%dplyr::rename(
sd_co2 = sd,
se_co2 = se,
ci_co2 = ci
)
summary_dm_peat <- summarySE(data=dataset_peat_out, measurevar="c_loss",
groupvars=c("trmt"), na.rm = T)%>%as_tibble()%>%dplyr::rename(
sd_dm = sd,
se_dm = se,
ci_dm = ci
)
summary_peat <- cbind(summary_cum_co2_peat, summary_dm_peat)%>%select(-c(2,7,8))
p_peat <- ggplot(data=dataset_peat_out, aes(x=c_loss, y=cum_co2_g))+
stat_smooth(formula = y~x, method = "lm", alpha= 0.3, color= "#0571b0")+
stat_cor(aes(label = paste(..rr.label.., ..p.label.., sep = "~`,`~")))+
# stat_cor(method = "pearson")+
geom_point(aes(shape = trmt), size=2)+
geom_point(data = summary_peat, aes(x=c_loss, y=cum_co2_g, shape = trmt), color="#ca0020", size=3.5)+
geom_errorbar(data = summary_peat, aes(xmin=c_loss-se_dm, xmax=c_loss+se_dm), color="#ca0020", width=0.5)+
geom_errorbar(data = summary_peat, aes(ymin=cum_co2_g-se_co2, ymax=cum_co2_g+se_co2), color="#ca0020", width=0.25)+
scale_shape_manual(name = "SCG (% of total mixture)",
values=c(15, 16, 17, 8),
labels = c("0%", "15%","30%", "50%"))+
scale_y_continuous(limits = c(0,21), breaks=seq(0, 25,5))+
scale_x_continuous(limits = c(0,21), breaks=seq(0, 20,5))+
labs(x = "Dry matter loss (grams)", y=expression(Cumulative~CO[2]~(grams)))+
theme_pubr()
p_peat
p_peat <- ggplot(data=dataset_peat_out, aes(x=c_loss, y=cum_co2_g))+
stat_smooth(formula = y~x, method = "lm", alpha= 0.3, color= "#0571b0")+
stat_cor(aes(label = paste(..rr.label.., ..p.label.., sep = "~`,`~")))+
# stat_cor(method = "pearson")+
geom_point(aes(shape = trmt), size=2)+
geom_point(data = summary_peat, aes(x=c_loss, y=cum_co2_g, shape = trmt), color="#ca0020", size=3.5)+
geom_errorbar(data = summary_peat, aes(xmin=c_loss-se_dm, xmax=c_loss+se_dm), color="#ca0020", width=0.5)+
geom_errorbar(data = summary_peat, aes(ymin=cum_co2_g-se_co2, ymax=cum_co2_g+se_co2), color="#ca0020", width=0.25)+
scale_shape_manual(name = "SCG (% of total mixture)",
values=c(15, 16, 17, 8),
labels = c("0%", "15%","30%", "50%"))+
scale_y_continuous(limits = c(0,21), breaks=seq(0, 25,5))+
# scale_x_continuous(limits = c(0,21), breaks=seq(0, 20,5))+
labs(x = "Dry matter loss (grams)", y=expression(Cumulative~CO[2]~(grams)))+
theme_pubr()
p_peat
p_peat <- ggplot(data=dataset_peat_out, aes(x=c_loss, y=cum_co2_g))+
stat_smooth(formula = y~x, method = "lm", alpha= 0.3, color= "#0571b0")+
stat_cor(aes(label = paste(..rr.label.., ..p.label.., sep = "~`,`~")))+
# stat_cor(method = "pearson")+
geom_point(aes(shape = trmt), size=2)+
geom_point(data = summary_peat, aes(x=c_loss, y=cum_co2_g, shape = trmt), color="#ca0020", size=3.5)+
geom_errorbar(data = summary_peat, aes(xmin=c_loss-se_dm, xmax=c_loss+se_dm), color="#ca0020", width=0.5)+
geom_errorbar(data = summary_peat, aes(ymin=cum_co2_g-se_co2, ymax=cum_co2_g+se_co2), color="#ca0020", width=0.25)+
scale_shape_manual(name = "SCG (% of total mixture)",
values=c(15, 16, 17, 8),
labels = c("0%", "15%","30%", "50%"))+
# scale_y_continuous(limits = c(0,21), breaks=seq(0, 25,5))+
# scale_x_continuous(limits = c(0,21), breaks=seq(0, 20,5))+
labs(x = "Dry matter loss (grams)", y=expression(Cumulative~CO[2]~(grams)))+
theme_pubr()
p_peat
View(dataset_peat_out)
View(cum_co2_peat)
View(dm_peat)
# dm_plug <- read_xlsx("DM_loss_plug.xlsx", sheet = "means")%>%as_tibble()%>%select(c(11))
cum_co2_plug <- read_csv("co2_cum_g_plug.csv")%>%as_tibble()%>%slice(-c(17))
dm_plug <- read_csv("C_mineralization_plug.csv")%>%as_tibble()%>%select(c(5))
dataset_plug <- cbind(cum_co2_plug, dm_plug)
dataset_plug$trmt <- as.factor(dataset_plug$trmt)
dataset_plug_out <- dataset_plug%>%slice(-c(3, 7, 10, 16))
#generating summary data
summary_cum_co2_plug <- summarySE(data=dataset_plug_out, measurevar="cum_co2_g",
groupvars=c("trmt"), na.rm = T)%>%as_tibble()%>%dplyr::rename(
sd_co2 = sd,
se_co2 = se,
ci_co2 = ci
)
summary_dm_plug <- summarySE(data=dataset_plug_out, measurevar="c_loss",
groupvars=c("trmt"), na.rm = T)%>%as_tibble()%>%dplyr::rename(
sd_dm = sd,
se_dm = se,
ci_dm = ci
)
summary_plug <- cbind(summary_cum_co2_plug, summary_dm_plug)%>%select(-c(2,7,8))
p_plug <- ggplot(data=dataset_plug_out, aes(x=c_loss, y=cum_co2_g))+
stat_smooth(formula = y~x, method = "lm", alpha= 0.3, color= "#0571b0")+
stat_cor(aes(label = paste(..rr.label.., ..p.label.., sep = "~`,`~")))+
# stat_cor(method = "pearson")+
geom_point(aes(shape = trmt), size=2)+
geom_point(data = summary_plug, aes(x=c_loss, y=cum_co2_g, shape = trmt), color="#ca0020", size=3.5)+
geom_errorbar(data = summary_plug, aes(xmin=c_loss-se_dm, xmax=c_loss+se_dm), color="#ca0020", width=0.5)+
geom_errorbar(data = summary_plug, aes(ymin=cum_co2_g-se_co2, ymax=cum_co2_g+se_co2), color="#ca0020", width=0.25)+
scale_shape_manual(name = "SCG (% of total mixture)",
values=c(15, 16, 17, 8),
labels = c("0%", "15%","30%", "50%"))+
scale_y_continuous(limits = c(0,21), breaks=seq(0, 25,5))+
scale_x_continuous(limits = c(0,21), breaks=seq(0, 20,5))+
labs(x = "Dry matter loss (grams)", y=expression(Cumulative~CO[2]~(grams)))+
theme_pubr()
p_plug
p_plug <- ggplot(data=dataset_plug_out, aes(x=c_loss, y=cum_co2_g))+
stat_smooth(formula = y~x, method = "lm", alpha= 0.3, color= "#0571b0")+
stat_cor(aes(label = paste(..rr.label.., ..p.label.., sep = "~`,`~")))+
# stat_cor(method = "pearson")+
geom_point(aes(shape = trmt), size=2)+
geom_point(data = summary_plug, aes(x=c_loss, y=cum_co2_g, shape = trmt), color="#ca0020", size=3.5)+
geom_errorbar(data = summary_plug, aes(xmin=c_loss-se_dm, xmax=c_loss+se_dm), color="#ca0020", width=0.5)+
geom_errorbar(data = summary_plug, aes(ymin=cum_co2_g-se_co2, ymax=cum_co2_g+se_co2), color="#ca0020", width=0.25)+
scale_shape_manual(name = "SCG (% of total mixture)",
values=c(15, 16, 17, 8),
labels = c("0%", "15%","30%", "50%"))+
# scale_y_continuous(limits = c(0,21), breaks=seq(0, 25,5))+
# scale_x_continuous(limits = c(0,21), breaks=seq(0, 20,5))+
labs(x = "Dry matter loss (grams)", y=expression(Cumulative~CO[2]~(grams)))+
theme_pubr()
p_plug
p_peat <- ggplot(data=dataset_peat_out, aes(x=c_loss, y=cum_co2_g))+
stat_smooth(formula = y~x, method = "lm", alpha= 0.3, color= "#0571b0")+
stat_cor(aes(label = paste(..rr.label.., ..p.label.., sep = "~`,`~")))+
# stat_cor(method = "pearson")+
geom_point(aes(shape = trmt), size=2)+
geom_point(data = summary_peat, aes(x=c_loss, y=cum_co2_g, shape = trmt), color="#ca0020", size=3.5)+
geom_errorbar(data = summary_peat, aes(xmin=c_loss-se_dm, xmax=c_loss+se_dm), color="#ca0020", width=0.5)+
geom_errorbar(data = summary_peat, aes(ymin=cum_co2_g-se_co2, ymax=cum_co2_g+se_co2), color="#ca0020", width=0.25)+
scale_shape_manual(name = "SCG (% of total mixture)",
values=c(15, 16, 17, 8),
labels = c("0%", "15%","30%", "50%"))+
# scale_y_continuous(limits = c(0,21), breaks=seq(0, 25,5))+
# scale_x_continuous(limits = c(0,21), breaks=seq(0, 20,5))+
labs(x = "TOC loss (grams)", y=expression(Cumulative~CO[2]~(grams)))+
theme_pubr()
p_peat
p_peat <- ggplot(data=dataset_peat_out, aes(x=c_loss, y=cum_co2_g))+
stat_smooth(formula = y~x, method = "lm", alpha= 0.3, color= "#0571b0")+
stat_cor(aes(label = paste(..rr.label.., ..p.label.., sep = "~`,`~")))+
# stat_cor(method = "pearson")+
geom_point(aes(shape = trmt), size=2)+
geom_point(data = summary_peat, aes(x=c_loss, y=cum_co2_g, shape = trmt), color="#ca0020", size=3.5)+
geom_errorbar(data = summary_peat, aes(xmin=c_loss-se_dm, xmax=c_loss+se_dm), color="#ca0020", width=0.5)+
geom_errorbar(data = summary_peat, aes(ymin=cum_co2_g-se_co2, ymax=cum_co2_g+se_co2), color="#ca0020", width=0.25)+
scale_shape_manual(name = "SCG (% of total mixture)",
values=c(15, 16, 17, 8),
labels = c("0%", "15%","30%", "50%"))+
# scale_y_continuous(limits = c(0,21), breaks=seq(0, 25,5))+
# scale_x_continuous(limits = c(0,21), breaks=seq(0, 20,5))+
labs(x = "TOC loss (grams)", y=expression(Cumulative~CO[2]~(grams)))+
theme_pubr()
p_peat
p_plug <- ggplot(data=dataset_plug_out, aes(x=c_loss, y=cum_co2_g))+
stat_smooth(formula = y~x, method = "lm", alpha= 0.3, color= "#0571b0")+
stat_cor(aes(label = paste(..rr.label.., ..p.label.., sep = "~`,`~")))+
# stat_cor(method = "pearson")+
geom_point(aes(shape = trmt), size=2)+
geom_point(data = summary_plug, aes(x=c_loss, y=cum_co2_g, shape = trmt), color="#ca0020", size=3.5)+
geom_errorbar(data = summary_plug, aes(xmin=c_loss-se_dm, xmax=c_loss+se_dm), color="#ca0020", width=0.5)+
geom_errorbar(data = summary_plug, aes(ymin=cum_co2_g-se_co2, ymax=cum_co2_g+se_co2), color="#ca0020", width=0.25)+
scale_shape_manual(name = "SCG (% of total mixture)",
values=c(15, 16, 17, 8),
labels = c("0%", "15%","30%", "50%"))+
# scale_y_continuous(limits = c(0,21), breaks=seq(0, 25,5))+
# scale_x_continuous(limits = c(0,21), breaks=seq(0, 20,5))+
labs(x = "TOC loss (grams)", y=expression(Cumulative~CO[2]~(grams)))+
theme_pubr()
p_plug
#_______________________________________________________________________________
## Compiling figures
fig <- ggarrange(p_peat, p_plug, labels = c("a", "b"),ncol = 2, nrow = 1,
common.legend = T, legend = "bottom")
ggsave(file="toc_loss_vs_co2.pdf", plot=fig, width=10, height=4.5)
