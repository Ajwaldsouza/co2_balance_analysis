theme(#legend.position = c(0.8, 0.75),
legend.direction = "horizontal",
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
legend.position="top")+
scale_fill_manual(name="",
labels = c("15:1", "25:1","35:1", "48:1"),
values = c("#e41a1c", "#377eb8", "#984ea3", "#ff7f00"),
guide = guide_legend())+
scale_color_manual(name="",
labels = c("15:1", "25:1","35:1", "48:1"),
values = c("#e41a1c", "#377eb8", "#984ea3", "#ff7f00"),
guide = guide_legend())+
labs(x="Time (days)", y= "Total carbon mineralisation (%)")+
stat_smooth(aes(color = trmt), method = 'nls', formula = 'y~a*(1-exp(-k*x))',
method.args = list(start=c(a=10, k =0.1)), se=F, size = 0.75)+
annotate(geom="text", x=1, y=0.2, label= TeX(r'($\textit{C_t= C_0(1-e^{-kt})}$)'))
fig_e3
# Plotting data with the generated data
fig_e3 <- ggplot(data=t_co2, aes(x=day, y=co2_per_kgdm, fill=trmt, color = trmt)) +
geom_point(alpha = 0,
position = position_jitter(width = 0.1, height = NULL))+
stat_summary(geom = "errorbar",
fun.data = "mean_se",
size =0.5,
width = 0.075)+
stat_summary(geom = "point",
fun.data = "mean_se",
size =1.5)+
scale_x_continuous(breaks = seq(0, 15, 2)) +
scale_y_continuous(
limits = c(0, 0.2),
breaks = seq(0, 0.25, 0.05)) +
theme_pubr()+
theme(axis.text = element_text(size = 11),
axis.title = element_text(size = 12),
axis.line = element_line(size = 0.4))+
theme(#legend.position = c(0.8, 0.75),
legend.direction = "horizontal",
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
legend.position="top")+
scale_fill_manual(name="",
labels = c("15:1", "25:1","35:1", "48:1"),
values = c("#e41a1c", "#377eb8", "#984ea3", "#ff7f00"),
guide = guide_legend())+
scale_color_manual(name="",
labels = c("15:1", "25:1","35:1", "48:1"),
values = c("#e41a1c", "#377eb8", "#984ea3", "#ff7f00"),
guide = guide_legend())+
labs(x="Time (days)", y= expression(Cumulative~CO[2]~(kg)/Initial~dry~matter~(kg)))+
stat_smooth(aes(color = trmt), method = 'nls', formula = 'y~a*(1-exp(-k*x))',
method.args = list(start=c(a=10, k =0.1)), se=F, size = 0.75)+
annotate(geom="text", x=1, y=0.2, label= TeX(r'($\textit{C_t= C_0(1-e^{-kt})}$)'))
fig_e3
# Plotting data with the generated data
fig_e3 <- ggplot(data=t_co2, aes(x=day, y=co2_per_kgdm, fill=trmt, color = trmt)) +
geom_point(alpha = 0,
position = position_jitter(width = 0.1, height = NULL))+
stat_summary(geom = "errorbar",
fun.data = "mean_se",
size =0.5,
width = 0.075)+
stat_summary(geom = "point",
fun.data = "mean_se",
size =1.5)+
scale_x_continuous(breaks = seq(0, 15, 2)) +
scale_y_continuous(
limits = c(0, 0.2),
breaks = seq(0, 0.25, 0.05)) +
theme_pubr()+
theme(axis.text = element_text(size = 11),
axis.title = element_text(size = 12),
axis.line = element_line(size = 0.4))+
theme(#legend.position = c(0.8, 0.75),
legend.direction = "horizontal",
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
legend.position="top")+
scale_fill_manual(name="",
labels = c("Mat-based", "Plug-based"),
values = c("#e41a1c", "#377eb8", "#984ea3", "#ff7f00"),
guide = guide_legend())+
scale_color_manual(name="",
labels = c("Mat-based", "Plug-based"),
values = c("#e41a1c", "#377eb8", "#984ea3", "#ff7f00"),
guide = guide_legend())+
labs(x="Time (days)", y= expression(Cumulative~CO[2]~(kg)/Initial~dry~matter~(kg)))+
stat_smooth(aes(color = trmt), method = 'nls', formula = 'y~a*(1-exp(-k*x))',
method.args = list(start=c(a=10, k =0.1)), se=F, size = 0.75)+
annotate(geom="text", x=1, y=0.2, label= TeX(r'($\textit{C_t= C_0(1-e^{-kt})}$)'))
fig_e3
plot(predict(fit2),                                # Draw plot using Base R
t2$c_min,
xlab = "Predicted Values",
ylab = "Observed Values")
plot(predict(fit2),                                # Draw plot using Base R
t2$co2_per_kgdm,
xlab = "Predicted Values",
ylab = "Observed Values")
cor(predict(fit1), t1$c_min)
cor(predict(fit1), t1$co2_per_kgdm)
cor(predict(fit2), t2$co2_per_kgdm)
fit2 <- nls(
co2_per_kgdm ~ a*(1-exp((-k)*day))+l*day,
data = t2,
start = list(a = 10, k = 0.1, l=0.01),
trace =  T
,
control = list(maxiter = 1000, warnOnly= T , minFactor = 1/1024)
)
summary(fit2)
fit2 <- nls(
co2_per_kgdm ~ a*(1-exp((-k)*day)),
data = t2,
start = list(a = 10, k = 0.1),
trace =  T
,
control = list(maxiter = 1000, warnOnly= T , minFactor = 1/1024)
)
summary(fit2)
fit2x <- nls(
co2_per_kgdm ~ a*(1-exp((-k)*day))+l*day,
data = t2,
start = list(a = 0.15, k = 0.2, l = 0.01),
trace =  T
,
control = list(maxiter = 1000, warnOnly= T , minFactor = 1/1024)
)
summary(fit2)
summary(fit2x)
# Plotting data with the generated data
fig_e3 <- ggplot(data=t_co2, aes(x=day, y=co2_per_kgdm, fill=trmt, color = trmt)) +
geom_point(alpha = 0,
position = position_jitter(width = 0.1, height = NULL))+
stat_summary(geom = "errorbar",
fun.data = "mean_se",
size =0.5,
width = 0.075)+
stat_summary(geom = "point",
fun.data = "mean_se",
size =1.5)+
scale_x_continuous(breaks = seq(0, 15, 2)) +
scale_y_continuous(
limits = c(0, 0.2),
breaks = seq(0, 0.25, 0.05)) +
theme_pubr()+
theme(axis.text = element_text(size = 11),
axis.title = element_text(size = 12),
axis.line = element_line(size = 0.4))+
theme(#legend.position = c(0.8, 0.75),
legend.direction = "horizontal",
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
legend.position="top")+
scale_fill_manual(name="",
labels = c("Mat-based", "Plug-based"),
values = c("#e41a1c", "#377eb8", "#984ea3", "#ff7f00"),
guide = guide_legend())+
scale_color_manual(name="",
labels = c("Mat-based", "Plug-based"),
values = c("#e41a1c", "#377eb8", "#984ea3", "#ff7f00"),
guide = guide_legend())+
labs(x="Time (days)", y= expression(Cumulative~CO[2]~(kg)/Initial~dry~matter~(kg)))+
# stat_smooth(aes(color = trmt), method = 'nls', formula = 'y~a*(1-exp(-k*x))',
#             method.args = list(start=c(a=10, k =0.1)), se=F, size = 0.75)+
stat_smooth(aes(color = trmt), method = 'nls', formula = 'y~a*(1-exp(-k*x))+l*x',
method.args = list(start=c(a = 0.15, k = 0.2, l = 0.01)), se=F, size = 0.75)+
annotate(geom="text", x=1, y=0.2, label= TeX(r'($\textit{C_t= C_0(1-e^{-kt})}$)'))
fig_e3
# Plotting data with the generated data
fig_e3 <- ggplot(data=t2, aes(x=day, y=co2_per_kgdm, fill=trmt, color = trmt)) +
geom_point(alpha = 0,
position = position_jitter(width = 0.1, height = NULL))+
stat_summary(geom = "errorbar",
fun.data = "mean_se",
size =0.5,
width = 0.075)+
stat_summary(geom = "point",
fun.data = "mean_se",
size =1.5)+
scale_x_continuous(breaks = seq(0, 15, 2)) +
scale_y_continuous(
limits = c(0, 0.2),
breaks = seq(0, 0.25, 0.05)) +
theme_pubr()+
theme(axis.text = element_text(size = 11),
axis.title = element_text(size = 12),
axis.line = element_line(size = 0.4))+
theme(#legend.position = c(0.8, 0.75),
legend.direction = "horizontal",
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
legend.position="top")+
scale_fill_manual(name="",
labels = c("Mat-based", "Plug-based"),
values = c("#e41a1c", "#377eb8", "#984ea3", "#ff7f00"),
guide = guide_legend())+
scale_color_manual(name="",
labels = c("Mat-based", "Plug-based"),
values = c("#e41a1c", "#377eb8", "#984ea3", "#ff7f00"),
guide = guide_legend())+
labs(x="Time (days)", y= expression(Cumulative~CO[2]~(kg)/Initial~dry~matter~(kg)))+
# stat_smooth(aes(color = trmt), method = 'nls', formula = 'y~a*(1-exp(-k*x))',
#             method.args = list(start=c(a=10, k =0.1)), se=F, size = 0.75)+
stat_smooth(aes(color = trmt), method = 'nls', formula = 'y~a*(1-exp(-k*x))+l*x',
method.args = list(start=c(a = 0.15, k = 0.2, l = 0.01)), se=F, size = 0.75)+
annotate(geom="text", x=1, y=0.2, label= TeX(r'($\textit{C_t= C_0(1-e^{-kt})}$)'))
fig_e3
plot(predict(fit2),                                # Draw plot using Base R
t2$co2_per_kgdm,
xlab = "Predicted Values",
ylab = "Observed Values")
plot(predict(fit2x),                                # Draw plot using Base R
t2$co2_per_kgdm,
xlab = "Predicted Values",
ylab = "Observed Values")
cor(predict(fit2x), t2$co2_per_kgdm)
cor(predict(fit2), t2$co2_per_kgdm)
fit2x <- nls(
co2_per_kgdm ~ a*(1-exp((-k)*day))+l*day,
data = t1,
start = list(a = 0.15, k = 0.2, l = 0.01),
trace =  T
,
control = list(maxiter = 1000, warnOnly= T , minFactor = 1/1024)
)
summary(fit2x)
fit2x <- nls(
co2_per_kgdm ~ a*(1-exp((-k)*day))+C,
data = t2,
start = list(a = 0.15, k = 0.2, C = 0.01),
trace =  T
,
control = list(maxiter = 1000, warnOnly= T , minFactor = 1/1024)
)
summary(fit2x)
fit2x <- nls(
co2_per_kgdm ~ a*(1-exp((-k)*day))+C,
data = t1,
start = list(a = 0.15, k = 0.2, C = 0.01),
trace =  T
,
control = list(maxiter = 1000, warnOnly= T , minFactor = 1/1024)
)
summary(fit2x)
fit2x <- nls(
co2_per_kgdm ~ a*(1-exp((-k)*day))+C,
data = t1,
start = list(a = 0.15, k = 0.2, C = 0.001),
trace =  T
,
control = list(maxiter = 1000, warnOnly= T , minFactor = 1/1024)
)
summary(fit2x)
fit2x <- nls(
co2_per_kgdm ~ a*(1-exp((-k)*day))+C*day,
data = t1,
start = list(a = 0.15, k = 0.2, C = 0.001),
trace =  T
,
control = list(maxiter = 1000, warnOnly= T , minFactor = 1/1024)
)
summary(fit2x)
fit2x <- nls(
co2_per_kgdm ~ a*(1-exp((-k)*day))+C*day,
data = t1,
start = list(a = 0.15, k = 0.2, C = 0.001),
trace =  T
,
control = list(maxiter = 1000, warnOnly= T , minFactor = 1/1000024)
)
summary(fit2x)
fit2x <- nls(
co2_per_kgdm ~ a*(1-exp((-k)*day))+C*day,
data = t1,
start = list(a = 0.15, k = 0.2, C = 0.001),
trace =  T
,
control = list(maxiter = 100000000, warnOnly= T , minFactor = 1/1000024)
)
summary(fit2x)
fit2x <- nls(
co2_per_kgdm ~ a*(1-exp((-k)*day))+C,
data = t1,
start = list(a = 0.15, k = 0.2, C = 0.01),
trace =  T
,
control = list(maxiter = 100000000, warnOnly= T , minFactor = 1/1000024)
)
summary(fit2x)
# Plotting data with the generated data
fig_e3 <- ggplot(data=t1, aes(x=day, y=co2_per_kgdm, fill=trmt, color = trmt)) +
geom_point(alpha = 0,
position = position_jitter(width = 0.1, height = NULL))+
stat_summary(geom = "errorbar",
fun.data = "mean_se",
size =0.5,
width = 0.075)+
stat_summary(geom = "point",
fun.data = "mean_se",
size =1.5)+
scale_x_continuous(breaks = seq(0, 15, 2)) +
scale_y_continuous(
limits = c(0, 0.2),
breaks = seq(0, 0.25, 0.05)) +
theme_pubr()+
theme(axis.text = element_text(size = 11),
axis.title = element_text(size = 12),
axis.line = element_line(size = 0.4))+
theme(#legend.position = c(0.8, 0.75),
legend.direction = "horizontal",
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
legend.position="top")+
scale_fill_manual(name="",
labels = c("Mat-based", "Plug-based"),
values = c("#e41a1c", "#377eb8", "#984ea3", "#ff7f00"),
guide = guide_legend())+
scale_color_manual(name="",
labels = c("Mat-based", "Plug-based"),
values = c("#e41a1c", "#377eb8", "#984ea3", "#ff7f00"),
guide = guide_legend())+
labs(x="Time (days)", y= expression(Cumulative~CO[2]~(kg)/Initial~dry~matter~(kg)))+
# stat_smooth(aes(color = trmt), method = 'nls', formula = 'y~a*(1-exp(-k*x))',
#             method.args = list(start=c(a=10, k =0.1)), se=F, size = 0.75)+
stat_smooth(aes(color = trmt), method = 'nls', formula = 'y~a*(1-exp(-k*x))+l*x',
method.args = list(start=c(a = 0.15, k = 0.2, l = 0.01)), se=F, size = 0.75)+
annotate(geom="text", x=1, y=0.2, label= TeX(r'($\textit{C_t= C_0(1-e^{-kt})}$)'))
fig_e3
# Plotting data with the generated data
fig_e3 <- ggplot(data=t1, aes(x=day, y=co2_per_kgdm, fill=trmt, color = trmt)) +
geom_point(alpha = 0,
position = position_jitter(width = 0.1, height = NULL))+
stat_summary(geom = "errorbar",
fun.data = "mean_se",
size =0.5,
width = 0.075)+
stat_summary(geom = "point",
fun.data = "mean_se",
size =1.5)+
scale_x_continuous(breaks = seq(0, 15, 2)) +
scale_y_continuous(
limits = c(0, 0.2),
breaks = seq(0, 0.25, 0.05)) +
theme_pubr()+
theme(axis.text = element_text(size = 11),
axis.title = element_text(size = 12),
axis.line = element_line(size = 0.4))+
theme(#legend.position = c(0.8, 0.75),
legend.direction = "horizontal",
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
legend.position="top")+
scale_fill_manual(name="",
labels = c("Mat-based", "Plug-based"),
values = c("#e41a1c", "#377eb8", "#984ea3", "#ff7f00"),
guide = guide_legend())+
scale_color_manual(name="",
labels = c("Mat-based", "Plug-based"),
values = c("#e41a1c", "#377eb8", "#984ea3", "#ff7f00"),
guide = guide_legend())+
labs(x="Time (days)", y= expression(Cumulative~CO[2]~(kg)/Initial~dry~matter~(kg)))+
# stat_smooth(aes(color = trmt), method = 'nls', formula = 'y~a*(1-exp(-k*x))',
#             method.args = list(start=c(a=10, k =0.1)), se=F, size = 0.75)+
stat_smooth(aes(color = trmt), method = 'nls', formula = 'y~a*(1-exp(-k*x))+l',
method.args = list(start=c(a = 0.15, k = 0.2, l = 0.01)), se=F, size = 0.75)+
annotate(geom="text", x=1, y=0.2, label= TeX(r'($\textit{C_t= C_0(1-e^{-kt})}$)'))
fig_e3
# Plotting data with the generated data
fig_e3 <- ggplot(data=t1, aes(x=day, y=co2_per_kgdm, fill=trmt, color = trmt)) +
geom_point(alpha = 0,
position = position_jitter(width = 0.1, height = NULL))+
stat_summary(geom = "errorbar",
fun.data = "mean_se",
size =0.5,
width = 0.075)+
stat_summary(geom = "point",
fun.data = "mean_se",
size =1.5)+
scale_x_continuous(breaks = seq(0, 15, 2)) +
scale_y_continuous(
limits = c(0, 0.2),
breaks = seq(0, 0.25, 0.05)) +
theme_pubr()+
theme(axis.text = element_text(size = 11),
axis.title = element_text(size = 12),
axis.line = element_line(size = 0.4))+
theme(#legend.position = c(0.8, 0.75),
legend.direction = "horizontal",
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
legend.position="top")+
scale_fill_manual(name="",
labels = c("Mat-based", "Plug-based"),
values = c("#e41a1c", "#377eb8", "#984ea3", "#ff7f00"),
guide = guide_legend())+
scale_color_manual(name="",
labels = c("Mat-based", "Plug-based"),
values = c("#e41a1c", "#377eb8", "#984ea3", "#ff7f00"),
guide = guide_legend())+
labs(x="Time (days)", y= expression(Cumulative~CO[2]~(kg)/Initial~dry~matter~(kg)))+
stat_smooth(aes(color = trmt), method = 'nls', formula = 'y~a*(1-exp(-k*x))',
method.args = list(start=c(a=10, k =0.1)), se=F, size = 0.75)+
annotate(geom="text", x=1, y=0.2, label= TeX(r'($\textit{C_t= C_0(1-e^{-kt})}$)'))
fig_e3
# Plotting data with the generated data
fig_e3 <- ggplot(data=t_co2, aes(x=day, y=co2_per_kgdm, fill=trmt, color = trmt)) +
geom_point(alpha = 0,
position = position_jitter(width = 0.1, height = NULL))+
stat_summary(geom = "errorbar",
fun.data = "mean_se",
size =0.5,
width = 0.075)+
stat_summary(geom = "point",
fun.data = "mean_se",
size =1.5)+
scale_x_continuous(breaks = seq(0, 15, 2)) +
scale_y_continuous(
limits = c(0, 0.2),
breaks = seq(0, 0.25, 0.05)) +
theme_pubr()+
theme(axis.text = element_text(size = 11),
axis.title = element_text(size = 12),
axis.line = element_line(size = 0.4))+
theme(#legend.position = c(0.8, 0.75),
legend.direction = "horizontal",
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
legend.position="top")+
scale_fill_manual(name="",
labels = c("Mat-based", "Plug-based"),
values = c("#e41a1c", "#377eb8", "#984ea3", "#ff7f00"),
guide = guide_legend())+
scale_color_manual(name="",
labels = c("Mat-based", "Plug-based"),
values = c("#e41a1c", "#377eb8", "#984ea3", "#ff7f00"),
guide = guide_legend())+
labs(x="Time (days)", y= expression(Cumulative~CO[2]~(kg)/Initial~dry~matter~(kg)))+
stat_smooth(aes(color = trmt), method = 'nls', formula = 'y~a*(1-exp(-k*x))',
method.args = list(start=c(a=10, k =0.1)), se=F, size = 0.75)+
annotate(geom="text", x=1, y=0.2, label= TeX(r'($\textit{C_t= C_0(1-e^{-kt})}$)'))
fig_e3
fit1 <- nls(
co2_per_kgdm ~ a*(1-exp((-k)*day)),
data = t1,
start = list(a = 10, k = 0.1),
trace =  T
,
control = list(maxiter = 1000, warnOnly= T , minFactor = 1/1024)
)
summary(fit1)
Anova(fit1)
anova(fit1)
fit1
summary(fit1)
summary(fit1)
summary(fit2)
librarian::shelf(tidyverse, ggplot2, dplyr, tibble, readr, lubridate, ggpubr,
scales, tidyr, rstudioapi,readxl,Rmisc,
update_all = FALSE)
##Setup working Directory
setwd(dirname(getActiveDocumentContext()$path))                                 # Set working directory to source file location
co2_cum_peat <- read_csv("co2_cum_g_peat.csv")%>%as_tibble()%>%
select(c(2,3))%>%
slice(c(1,2,4))%>%
mutate(cum_co2_g = cum_co2_g/57.89)
co2_cum_plug <- read_csv("co2_cum_g_plug.csv")%>%as_tibble()%>%
select(c(2,3))%>%
slice(c(1,2,4))%>%
mutate(cum_co2_g = cum_co2_g/47.7)
cum_co2 <- rbind(co2_cum_peat, co2_cum_plug)
cum_co2$cum_co2_g <- as.numeric(cum_co2$cum_co2_g)
cum_co2$trmt <- as.factor(cum_co2$trmt)
#ANOVA
model1 <- lm(cum_co2_g ~ trmt, data = cum_co2)
#Tukeys test
library(agricolae)
HSD.test(model1, "trmt", group=T, alpha = 0.05, console = T)
summary <- summarySE(data=cum_co2, measurevar="cum_co2_g",
groupvars=c("trmt"), na.rm = T)%>%as_tibble()
#add tukey comparison groups
summary$tukey <- c("a", "b")
p <- ggplot(data=summary, aes(x=trmt, y=cum_co2_g))+
geom_bar(stat= "identity", width = 0.75, fill="#bdbdbd")+
geom_point(data=cum_co2, stat = "identity", size=3,
#alpha=0.95,
color = "#e34a33",
position = position_jitter(width = 0.2)
)+
geom_errorbar(aes(ymin=cum_co2_g-se, ymax=cum_co2_g+se), width=.2,
position = position_dodge2(width=0.85))+
geom_text(aes(label=round(cum_co2_g, digits = 3)),
position=position_dodge(width=0.9), vjust=4, size=4)+
geom_text(aes(label=tukey), nudge_y=0.02,  size=4)+
scale_y_continuous(expand=c(0,0), limits = c(0, 0.2))+
scale_x_discrete(labels=c("peat" = "Mat-based", "plug" = "Plug-based"))+
labs(x = "CEA biowaste type", y= expression(Total~CO[2]~(kg)/Initial~dry~matter~(kg)))+
theme_pubr()
p
summary(fit1)
summary(fit2)
#Saving the plot
# Call the pdf command to start the plot
pdf(file = "cum_co2.pdf",   # The directory you want to save the file in
width = 5.83, # The width of the plot in inches
height = 4.13)
p
dev.off()
summary <- summarySE(data=cum_co2, measurevar="cum_co2_g",
groupvars=c("trmt"), na.rm = T)%>%as_tibble()
summary
